function t(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function n(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}function i(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&s(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function s(t,e){return(s=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(t){return!1}}function c(t,e,n){return(c=l()?Reflect.construct:function(t,e,n){var i=[null];i.push.apply(i,e);var r=new(Function.bind.apply(t,i));return n&&s(r,n.prototype),r}).apply(null,arguments)}function a(t){var e="function"==typeof Map?new Map:void 0;return(a=function(t){if(null===t||(n=t,-1===Function.toString.call(n).indexOf("[native code]")))return t;var n;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,i)}function i(){return c(t,arguments,o(this).constructor)}return i.prototype=Object.create(t.prototype,{constructor:{value:i,enumerable:!1,writable:!0,configurable:!0}}),s(i,t)})(t)}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?u(t):e}function d(t){var e=l();return function(){var n,i=o(t);if(e){var r=o(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return h(this,n)}}function f(t,e,n){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,n){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var r=Object.getOwnPropertyDescriptor(i,e);return r.get?r.get.call(n):r.value}})(t,e,n||t)}function v(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],i=!0,r=!1,o=void 0;try{for(var s,l=t[Symbol.iterator]();!(i=(s=l.next()).done)&&(n.push(s.value),!e||n.length!==e);i=!0);}catch(t){r=!0,o=t}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}return n}(t,e)||S(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(t){return function(t){if(Array.isArray(t))return p(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||S(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function S(t,e){if(t){if("string"==typeof t)return p(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?p(t,e):void 0}}function p(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}var b=function(t,e,n){var i=t.x,r=t.y,o=n.x,s=n.y;return{"+":{x:i+o,y:r+s},"-":{x:i-o,y:r-s},"*":{x:i*o,y:r*s}}[e]},y=function(t){return{x:t.left,y:t.top}},_=function(){var t,e,n,i;return{y:(null===(t=document.body)||void 0===t?void 0:t.scrollTop)||(null===(e=document.documentElement)||void 0===e?void 0:e.scrollTop)||0,x:(null===(n=document.body)||void 0===n?void 0:n.scrollLeft)||(null===(i=document.documentElement)||void 0===i?void 0:i.scrollLeft)||0}},g=function(t){return!t||t instanceof Document?_():{x:t.scrollLeft>=0?t.scrollLeft:_().x,y:t.scrollTop>=0?t.scrollTop:_().y}},w=function(t){var e=t.event;return{x:e.clientX,y:e.clientY}},D=function(t){var e=t.getBoundingClientRect();return{x:e.left,y:e.top,w:e.width,h:e.height}},k=function(t,e){return t.x<e.x+e.w&&t.x+t.w>e.x&&t.y<e.y+e.h&&t.h+t.y>e.y},E=function(t){return t?!Array.isArray(t)&&(t instanceof HTMLElement||t instanceof SVGElement)?[t]:m(t):[]},A=function(t,e){t.style.left="".concat(e.x,"px"),t.style.top="".concat(e.y,"px"),t.style.width="".concat(e.w,"px"),t.style.height="".concat(e.h,"px")},L=function(){function e(n){var r=this,o=n.area,s=n.PS,l=n.zoom;t(this,e),i(this,"_modificationCallback",void 0),i(this,"_modificationObserver",void 0),i(this,"_zoom",void 0),i(this,"_node",void 0),i(this,"_parentNodes",void 0),i(this,"_computedStyle",void 0),i(this,"_computedBorder",void 0),i(this,"_boundingClientRect",void 0),i(this,"start",(function(){var t,e,n;t=r.parentNodes,e=r._modificationCallback,n=r._modificationObserver,window.addEventListener("resize",e),window.addEventListener("scroll",e),t.forEach((function(t,e){n.observe(t,{childList:0!==e,attributes:!0})}))})),i(this,"reset",(function(){r._computedStyle=void 0,r._boundingClientRect=void 0,r._computedBorder=void 0,r._parentNodes=void 0})),i(this,"stop",(function(){var t,e;t=r._modificationObserver,e=r._modificationCallback,window.removeEventListener("resize",e),window.removeEventListener("scroll",e),t.disconnect(),r.reset()})),i(this,"scroll",(function(t,e){!function(t,e,n){if(e.length){var i=document&&document.documentElement&&document.documentElement.scrollTop&&document.documentElement,r=t instanceof HTMLDocument?i||document.body:t,o=e.includes("top")&&r.scrollTop>0,s=e.includes("bottom")&&r.scrollTop<r.scrollHeight,l=e.includes("left")&&r.scrollLeft>0,c=e.includes("right")&&r.scrollLeft<r.scrollWidth;o&&(r.scrollTop-=1*n),s&&(r.scrollTop+=1*n),l&&(r.scrollLeft-=1*n),c&&(r.scrollLeft+=1*n)}}(r._node,t,e),r.PubSub.publish("Area:scroll",{data:{directions:t,multiplier:e}})})),this._node=o,this._zoom=l,this.PubSub=s;var c,a,u,h=this.computedStyle.position,d="absolute"===h||"relative"===h||"fixed"===h;this._node instanceof HTMLDocument||d||(this._node.style.position="relative"),this._modificationCallback=(c=function(t){r.reset(),r.PubSub.publish("Area:modified",{event:t,item:r})},a=60,function(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=function(){u=null,c.apply(void 0,e)};clearTimeout(u),u=setTimeout(i,a)}),this._modificationObserver=new MutationObserver(this._modificationCallback),setTimeout((function(){r.reset(),r.PubSub.publish("Area:modified",{event:event,item:r})})),this.PubSub.subscribe("Interaction:init",this.start),this.PubSub.subscribe("Interaction:end",this.reset)}return n(e,[{key:"HTMLNode",get:function(){return this._node}},{key:"computedBorder",get:function(){return this._computedBorder?this._computedBorder:{top:parseInt(this.computedStyle.borderTopWidth),bottom:parseInt(this.computedStyle.borderBottomWidth),left:parseInt(this.computedStyle.borderLeftWidth),right:parseInt(this.computedStyle.borderRightWidth)}}},{key:"computedStyle",get:function(){return this._computedStyle?this._computedStyle:this.HTMLNode instanceof HTMLDocument?this._computedStyle=getComputedStyle(this.HTMLNode.body||this.HTMLNode.documentElement):this._computedStyle=getComputedStyle(this.HTMLNode)}},{key:"boundingClientRect",get:function(){return this._boundingClientRect?this._boundingClientRect:this._boundingClientRect=function(t,e){if(t instanceof Document)return{top:0,left:0,bottom:0,right:0,width:window.innerWidth,height:window.innerHeight};var n=t.getBoundingClientRect();return{top:n.top,left:n.left,bottom:n.bottom,right:n.right,width:t.clientWidth*e,height:t.clientHeight*e}}(this.HTMLNode,this._zoom)}},{key:"parentNodes",get:function(){if(this._parentNodes)return this._parentNodes;return this._parentNodes=function t(e){var n,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=null===(n=e[i])||void 0===n?void 0:n.parentNode;return r?(e.push(r),t(e,++i)):e}([this.HTMLNode]),this._parentNodes}}]),e}(),C=function e(n){var r=this,o=n.areaElement,s=n.DS,l=n.stopForMove;t(this,e),i(this,"_areaElement",void 0),i(this,"_stopForMove",void 0),i(this,"init",(function(){r.stop(),r._areaElement.addEventListener("mousedown",r.start),r._areaElement.addEventListener("touchstart",r.start,{passive:!1}),r.DS.publish("Interaction:init",{})})),i(this,"start",(function(t){"touchstart"===t.type&&t.preventDefault(),2!==t.button&&(r._stopForMove&&!r.DS.stores.KeyStore.isMultiSelectKeyPressed(t)&&r.DS.SelectedSet.has(t.target)||(r.isInteracting=!0,r.DS.publish("Interaction:start",{event:t}),document.addEventListener("mouseup",r.reset),document.addEventListener("touchend",r.reset)))})),i(this,"stop",(function(){r.isInteracting=!1,r._areaElement.removeEventListener("mousedown",r.start),r._areaElement.removeEventListener("touchstart",r.start,{passive:!1}),document.removeEventListener("mouseup",r.reset),document.removeEventListener("touchend",r.reset)})),i(this,"update",(function(t){var e=t.event,n=t.data;r.isInteracting&&r.DS.publish("Interaction:update",{event:e,data:n})})),i(this,"reset",(function(t){r.stop(),r.init(),r.DS.publish("Interaction:end",{event:t})})),this._areaElement=o,this._stopForMove=l,this.DS=s,this.DS.subscribe("PointerStore:updated",this.update),this.DS.subscribe("Area:scroll",this.update)},x=function e(){var n=this;t(this,e),i(this,"subscribers",{}),i(this,"subscribe",(function(t,e){return Array.isArray(n.subscribers[t])||(n.subscribers[t]=[]),n.subscribers[t].push(e),n.subscribers[t].length-1})),i(this,"unsubscribe",(function(t,e,i){i>=0?n.subscribers[t].splice(i,1):e&&(n.subscribers[t]=n.subscribers[t].filter((function(t){return t!==e})))})),i(this,"publish",(function(t,e){Array.isArray(n.subscribers[t])&&n.subscribers[t].forEach((function(t){return t(e)}))}))},P=function(e){r(l,a(Set));var s=d(l);function l(e){var n,r=e.elements,o=e.className,c=e.hoverClassName,a=e.DS;return t(this,l),i(u(n=s.call(this)),"_initElements",void 0),i(u(n),"_className",void 0),i(u(n),"_hoverClassName",void 0),i(u(n),"init",(function(){return n._initElements.forEach((function(t){return n.add(t)}))})),i(u(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(u(n),"_onClick",(function(t){return n.DS.publish("Selectable:click",{event:t})})),i(u(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(u(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=a,n._initElements=E(r),n._className=o,n._hoverClassName=c,n.DS.subscribe("Interaction:init",n.init),n}return n(l,[{key:"add",value:function(t){return t.classList.add(this._className),t.addEventListener("click",this._onClick),f(o(l.prototype),"add",this).call(this,t)}},{key:"delete",value:function(t){return t.classList.remove(this._className),t.classList.remove(this._hoverClassName),t.removeEventListener("click",this._onClick),f(o(l.prototype),"delete",this).call(this,t)}},{key:"elements",get:function(){return Array.from(this.values())}}]),l}(),M=function(e){r(l,a(Set));var s=d(l);function l(e){var n,r=e.className,o=e.DS;return t(this,l),i(u(n=s.call(this)),"_className",void 0),i(u(n),"clear",(function(){return n.forEach((function(t){return n.delete(t)}))})),i(u(n),"addAll",(function(t){return t.forEach((function(t){return n.add(t)}))})),i(u(n),"deleteAll",(function(t){return t.forEach((function(t){return n.delete(t)}))})),n.DS=o,n._className=r,n}return n(l,[{key:"add",value:function(t){return t.classList.add(this._className),f(o(l.prototype),"add",this).call(this,t),this.DS.publish("Selected:added",{items:this.elements,item:t}),this}},{key:"delete",value:function(t){t.classList.remove(this._className);var e=f(o(l.prototype),"delete",this).call(this,t);return this.DS.publish("Selected:removed",{items:this.elements,item:t}),e}},{key:"toggle",value:function(t){return this.has(t)?this.delete(t):this.add(t),t}},{key:"elements",get:function(){return Array.from(this.values())}}]),l}(),V=function(){function e(n){var r=this,o=n.DS,s=n.hoverClassName,l=n.multiSelectToggling;t(this,e),i(this,"_prevSelected",void 0),i(this,"_hoverClassName",void 0),i(this,"_multiSelectToggling",void 0),i(this,"_onClick",(function(t){var e=t.event;return r.handleClick(e)})),i(this,"start",(function(t){var e=t.event;r._storePrevious(e),r._checkIfInsideSelection(!0,e)})),i(this,"update",(function(){return r._checkIfInsideSelection()})),i(this,"_webWorker",(function(t){var e=new Blob(["\n        onmessage = function(event) {\n          const elements = event.data\n          const elPosCombo = elements.map(\n            (element) => {\n              const rect = element.getBoundingClientRect()\n              const pos = {\n                y: rect.top,\n                x: rect.left,\n                h: rect.height,\n                w: rect.width,\n              }\n              return [element, pos]\n            }\n          )\n\n          postMessage(elPosCombo)\n        }\n      "]),n=window.URL.createObjectURL(e),i=new Worker(n);i.postMessage({elements:t}),i.addEventListener("message",(function(t){var e=t.data;console.log("walala",e)})),i.addEventListener("error",(function(t){return console.log(t)})),i.addEventListener("messageerror",(function(t){return console.log(t)}))})),i(this,"_checkIfInsideSelection",(function(t,e){var n=r.DS,i=n.SelectableSet,o=n.SelectorArea,s=n.Selector;r._webWorker(i.elements);var l,c=[],a=[],u=function(t,e){var n;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(n=S(t))||e&&t&&"number"==typeof t.length){n&&(t=n);var i=0,r=function(){};return{s:r,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,l=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return s=t.done,t},e:function(t){l=!0,o=t},f:function(){try{s||null==n.return||n.return()}finally{if(l)throw o}}}}(i.elements.map((function(t){var e=t.getBoundingClientRect();return[t,{y:e.top,x:e.left,h:e.height,w:e.width}]})));try{for(u.s();!(l=u.n()).done;){var h=v(l.value,2),d=h[0],f=h[1];o.isInside(d,f)&&(k(f,s.position)?c.push(d):a.push(d))}}catch(t){u.e(t)}finally{u.f()}return c.forEach((function(n){return r._handleSelection(n,t,e)})),a.forEach((function(e){return r._handleUnselection(e,t)})),c.length>-1})),this._hoverClassName=s,this._multiSelectToggling=l,this.DS=o,this.DS.subscribe("Selectable:click",this._onClick),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update)}return n(e,[{key:"_storePrevious",value:function(t){var e=this.DS,n=e.stores.KeyStore,i=e.SelectedSet;n.isMultiSelectKeyPressed(t)?this._prevSelected=new Set(i):this._prevSelected=new Set}},{key:"handleClick",value:function(t){var e=this.DS,n=e.stores,i=n.PointerStore,r=n.KeyStore,o=e.SelectorArea,s=e.SelectableSet,l=e.SelectedSet,c=e.publish;if(2!==t.button&&!i.isMouseInteraction){i.start(t);var a=t.target;s.has(a)&&o.isInside(a)&&(r.isMultiSelectKeyPressed(t)||l.clear(),l.toggle(a),c("Interaction:end",{event:t}))}}},{key:"_handleSelection",value:function(t,e,n){if(t.className.indexOf(this._hoverClassName)>0&&!e)return!1;var i=this.DS,r=i.SelectedSet,o=i.stores.KeyStore;r.has(t)?o.isMultiSelectKeyPressed(n)&&this._multiSelectToggling&&r.delete(t):r.add(t),t.classList.add(this._hoverClassName)}},{key:"_handleUnselection",value:function(t,e){if(t.className.indexOf(this._hoverClassName)<0&&!e)return!1;var n=this.DS.SelectedSet,i=n.has(t),r=this._prevSelected.has(t);i&&!r?n.delete(t):!i&&r&&n.add(t),t.classList.remove(this._hoverClassName)}}]),e}(),I=function(){function e(n){var r=this,o=n.DS,s=n.selector,l=n.selectorClass,c=n.customStyles;t(this,e),i(this,"_position",void 0),i(this,"start",(function(){var t=r.DS.stores.PointerStore.initialValArea;A(r.HTMLNode,{x:t.x,y:t.y,w:1,h:1}),r.HTMLNode.style.display="block",r._position=null})),i(this,"stop",(function(){r.HTMLNode.style.width="0",r.HTMLNode.style.height="0",r.HTMLNode.style.display="none"})),i(this,"update",(function(){var t=r.DS.stores,e=t.ScrollStore,n=t.PointerStore,i=function(t){var e=t.scrollAmount,n=t.initialPointerPos,i=t.pointerPos,r={};return i.x>n.x-e.x?(r.x=n.x-e.x,r.w=i.x-n.x+e.x):(r.x=i.x,r.w=n.x-i.x-e.x),i.y>n.y-e.y?(r.y=n.y-e.y,r.h=i.y-n.y+e.y):(r.y=i.y,r.h=n.y-i.y-e.y),r}({scrollAmount:e.scrollAmount,initialPointerPos:n.initialValArea,pointerPos:n.currentValArea});A(r.HTMLNode,i),r._position=null})),this.DS=o,this.HTMLNode=s||function(t){var e=document.createElement("div");return e.style.position="absolute",t||(e.style.background="rgba(0, 0, 255, 0.1)",e.style.border="1px solid rgba(0, 0, 255, 0.45)",e.style.display="none",e.style.pointerEvents="none"),e}(c),this.HTMLNode.classList.add(l),this.DS.subscribe("Interaction:start",this.start),this.DS.subscribe("Interaction:update",this.update),this.DS.subscribe("Interaction:end",this.stop)}return n(e,[{key:"position",get:function(){return this._position?this._position:this._position=D(this.HTMLNode)}}]),e}(),T=function(){function e(n){var r=this,o=n.DS,s=n.selectorAreaClass,l=n.autoScrollSpeed;t(this,e),i(this,"_autoScrollSpeed",void 0),i(this,"_scrollInterval",void 0),i(this,"_position",void 0),i(this,"updatePos",(function(){r._position=null;var t=r.DS.Area.boundingClientRect,e=r.DS.Area.computedBorder,n=r.HTMLNode.style,i="".concat(t.top+e.top,"px"),o="".concat(t.left+e.left,"px"),s="".concat(t.width,"px"),l="".concat(t.height,"px");n.top!==i&&(n.top=i),n.left!==o&&(n.left=o),n.width!==s&&(n.width=s),n.height!==l&&(n.height=l)})),i(this,"startAutoScroll",(function(){return r._scrollInterval=setInterval((function(){return r.handleAutoScroll()}),16)})),i(this,"handleAutoScroll",(function(){var t=r.DS,e=t.stores.PointerStore,n=t.Area,i=function(t){var e=t.position,n=t.boundingRect,i=10,r=10,o=[];return e.y<r&&o.push("top"),n.height-e.y<r&&o.push("bottom"),n.width-e.x<i&&o.push("right"),e.x<i&&o.push("left"),o}({position:e.currentValArea,boundingRect:n.boundingClientRect});i.length&&n.scroll(i,r._autoScrollSpeed)})),i(this,"stopAutoScroll",(function(){return clearInterval(r._scrollInterval)})),i(this,"isInside",(function(t,e){return!(!r.DS.Area.HTMLNode.contains(t)||!r.DS.stores.ScrollStore.canScroll)||k(r.position,e||D(t))})),this._autoScrollSpeed=l,this.DS=o,this.HTMLNode=function(t){var e=document.createElement("div");return e.style.position="fixed",e.style.overflow="hidden",e.style.pointerEvents="none",e.classList.add(t),e}(s),this.HTMLNode.append(this.DS.Selector.HTMLNode);var c=document.body?"body":"documentElement";document[c].append(this.HTMLNode),this.DS.subscribe("Area:modified",this.updatePos),this.DS.subscribe("Interaction:start",this.startAutoScroll),this.DS.subscribe("Interaction:end",this.stopAutoScroll)}return n(e,[{key:"isClicked",value:function(){var t=this.DS.stores.PointerStore,e={x:t.initialVal.x,y:t.initialVal.y,w:0,h:0};return k(e,this.position)}},{key:"position",get:function(){return this._position?this._position:this._position=D(this.HTMLNode)}}]),e}(),N=function(){function e(n){var r=this,o=n.DS,s=n.multiSelectKeys,l=n.multiSelectMode;t(this,e),i(this,"_multiSelectMode",void 0),i(this,"_multiSelectKeys",void 0),i(this,"_currentValues",new Set),i(this,"_keyMapping",{control:"ctrlKey",shift:"shiftKey",meta:"metaKey"}),i(this,"init",(function(){document.addEventListener("keydown",r.keydown),document.addEventListener("keyup",r.keyup),window.addEventListener("blur",r.reset)})),i(this,"keydown",(function(t){return r._currentValues.add(t.key.toLowerCase())})),i(this,"keyup",(function(t){return r._currentValues.delete(t.key.toLowerCase())})),i(this,"stop",(function(){document.removeEventListener("keydown",r.keydown),document.removeEventListener("keyup",r.reset),window.removeEventListener("blur",r.reset),r.reset()})),i(this,"reset",(function(){r._currentValues.clear(),r._isMultiSelect=!1})),this.DS=o,this._multiSelectMode=l,this._multiSelectKeys=s.map((function(t){var e={ctrlKey:"Control",shiftKey:"Shift",metaKey:"Meta"}[t];return e?(console.warn("[DragSelect] ".concat(t,' is deprecated. Use "').concat(e,'" instead. Act Now!. See docs for more info')),e.toLowerCase()):t.toLowerCase()})),this.DS.subscribe("Interaction:init",this.init)}return n(e,[{key:"isMultiSelectKeyPressed",value:function(t){var e=this;return!!this._multiSelectMode||(!!this.currentValues.some((function(t){return e._multiSelectKeys.includes(t)}))||!(!t||!this._multiSelectKeys.some((function(n){return t[e._keyMapping[n]]}))))}},{key:"currentValues",get:function(){return Array.from(this._currentValues.values())}}]),e}(),H=function(){function e(n){var r=this,o=n.DS;t(this,e),i(this,"_isMouseInteraction",!1),i(this,"_initialValArea",void 0),i(this,"_currentValArea",void 0),i(this,"_lastValArea",void 0),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_lastVal",void 0),i(this,"_lastTouch",void 0),i(this,"init",(function(){document.addEventListener("mousemove",r.update),document.addEventListener("touchmove",r.update,{passive:!1})})),i(this,"update",(function(t){t&&(r.currentVal=w({event:r._normalizedEvent(t)}),r._isMouseInteraction&&r.DS.publish("PointerStore:updated",{event:t}))})),i(this,"stop",(function(){document.removeEventListener("mousemove",r.update),document.removeEventListener("touchmove",r.update,{passive:!1}),setTimeout((function(){return r._isMouseInteraction=!1}),100)})),i(this,"reset",(function(t){t&&(r.currentVal=r.lastVal=w({event:r._normalizedEvent(t)}),r.stop(),r.init())})),this.DS=o,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(t){var e=t.event;return r.start(e)})),this.DS.subscribe("Interaction:end",(function(t){var e=t.event;return r.reset(e)}))}return n(e,[{key:"start",value:function(t){t&&(this._isMouseInteraction=!0,this.currentVal=this.initialVal=w({event:this._normalizedEvent(t)}))}},{key:"_normalizedEvent",value:function(t){return"touches"in t&&"touchend"!==t.type&&(this._lastTouch=t),"touches"in t?this._lastTouch.touches[0]:t}},{key:"isMouseInteraction",get:function(){return this._isMouseInteraction}},{key:"initialValArea",get:function(){return this._initialValArea?this._initialValArea:{x:0,y:0}}},{key:"currentValArea",get:function(){return this._currentValArea?this._currentValArea:{x:0,y:0}}},{key:"lastValArea",get:function(){return this._lastValArea?this._lastValArea:{x:0,y:0}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}},set:function(t){this._initialVal=t,this._initialValArea=t&&b(t,"-",b(y(this.DS.Area.boundingClientRect),"+",y(this.DS.Area.computedBorder)))}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}},set:function(t){this._currentVal=t,this._currentValArea=t&&b(t,"-",b(y(this.DS.Area.boundingClientRect),"+",y(this.DS.Area.computedBorder)))}},{key:"lastVal",get:function(){return this._lastVal?this._lastVal:{x:0,y:0}},set:function(t){this._lastVal=t,this._lastValArea=t&&b(t,"-",b(y(this.DS.Area.boundingClientRect),"+",y(this.DS.Area.computedBorder)))}}]),e}(),O=function(){function e(n){var r=this,o=n.DS,s=n.areaElement,l=n.zoom;t(this,e),i(this,"_initialVal",void 0),i(this,"_currentVal",void 0),i(this,"_areaElement",void 0),i(this,"_canScroll",void 0),i(this,"init",(function(){return r._areaElement.addEventListener("scroll",r.update)})),i(this,"start",(function(){r._currentVal=r._initialVal=g(r._areaElement),r._areaElement.addEventListener("scroll",r.update)})),i(this,"update",(function(){return r._currentVal=g(r._areaElement)})),i(this,"stop",(function(){r._areaElement.removeEventListener("scroll",r.update),r._initialVal={x:0,y:0},r._canScroll=null})),i(this,"reset",(function(){r.stop(),r.start()})),this._areaElement=s,this.DS=o,this.zoom=l,this.DS.subscribe("Interaction:init",this.init),this.DS.subscribe("Interaction:start",(function(){return r.start()})),this.DS.subscribe("Interaction:end",(function(){return r.reset()}))}return n(e,[{key:"canScroll",get:function(){return"boolean"==typeof this._canScroll?this._canScroll:this._canScroll=(t=this._areaElement,!!((e=g(t)).x||e.y||(t instanceof HTMLDocument?t.body?t.body.scrollTop=1:t.documentElement.scrollTop=1:t.scrollTop=1)));var t,e}},{key:"scrollAmount",get:function(){var t,e=b(this.currentVal,"-",this.initialVal),n={x:t=this.zoom,y:t},i=b(b(e,"*",n),"-",e);return{x:e.x+i.x,y:e.y+i.y}}},{key:"initialVal",get:function(){return this._initialVal?this._initialVal:{x:0,y:0}}},{key:"currentVal",get:function(){return this._currentVal?this._currentVal:{x:0,y:0}}}]),e}(),R=function(){function e(n){var r=this,o=n.area,s=void 0===o?document:o,l=n.selectables,c=void 0===l?[]:l,a=n.autoScrollSpeed,u=void 0===a?10:a,h=n.zoom,d=void 0===h?1:h,f=n.customStyles,v=void 0!==f&&f,m=n.multiSelectMode,S=void 0!==m&&m,p=n.multiSelectToggling,b=void 0===p||p,y=n.multiSelectKeys,_=void 0===y?["Control","Shift","Meta"]:y,g=n.selector,w=void 0===g?void 0:g,D=n.stopForMove,k=void 0!==D&&D,E=n.hoverClass,A=void 0===E?"ds-hover":E,R=n.selectableClass,K=void 0===R?"ds-selectable":R,j=n.selectedClass,B=void 0===j?"ds-selected":j,z=n.selectorClass,U=void 0===z?"ds-selector":z,W=n.selectorAreaClass,F=void 0===W?"ds-selector-area":W,G=n.callback,X=n.onDragMove,Y=n.onDragStartBegin,$=n.onDragStart,q=n.onElementSelect,J=n.onElementUnselect;t(this,e),i(this,"start",(function(){return r.Interaction.init()})),i(this,"getSelection",(function(){return r.SelectedSet.elements})),i(this,"getSelectables",(function(){return r.SelectableSet.elements})),i(this,"getInitialCursorPosition",(function(){return r.stores.PointerStore.initialVal})),i(this,"getCurrentCursorPosition",(function(){return r.stores.PointerStore.currentVal})),i(this,"getPreviousCursorPosition",(function(){return r.stores.PointerStore.lastVal})),i(this,"getInitialCursorPositionArea",(function(){return r.stores.PointerStore.initialValArea})),i(this,"getCurrentCursorPositionArea",(function(){return r.stores.PointerStore.currentValArea})),i(this,"getPreviousCursorPositionArea",(function(){return r.stores.PointerStore.lastValArea})),i(this,"isMultiSelect",(function(t){return r.stores.KeyStore.isMultiSelectKeyPressed(t)})),this.PubSub=new x,this.subscribe=this.PubSub.subscribe,this.unsubscribe=this.PubSub.unsubscribe,this.publish=this.PubSub.publish,this._callbacksTemp({callback:G,onDragMove:X,onDragStart:$,onDragStartBegin:Y,onElementSelect:q,onElementUnselect:J}),this.stores={PointerStore:new H({DS:this}),ScrollStore:new O({DS:this,areaElement:s,zoom:d}),KeyStore:new N({DS:this,multiSelectKeys:_,multiSelectMode:S})},this.Area=new L({area:s,PS:this.PubSub,zoom:d}),this.Selector=new I({DS:this,selector:w,selectorClass:U,customStyles:v}),this.SelectorArea=new T({DS:this,selectorAreaClass:F,autoScrollSpeed:u}),this.SelectableSet=new P({elements:c,DS:this,className:K,hoverClassName:A}),this.SelectedSet=new M({DS:this,className:B}),this.Selection=new V({DS:this,hoverClassName:A,multiSelectToggling:b}),this.Interaction=new C({areaElement:s,DS:this,stopForMove:k}),this.subscribe("Selected:added",(function(t){var e=t.items,n=t.item;return r.publish("elementselect",{items:e,item:n})})),this.subscribe("Selected:removed",(function(t){var e=t.items,n=t.item;return r.publish("elementunselect",{items:e,item:n})})),this.subscribe("Interaction:update",(function(t){var e=t.event,n=t.data;e&&!n&&r.publish("dragmove",{items:r.getSelection(),event:e}),!e&&n&&r.publish("autoscroll",{data:n})})),this.subscribe("Interaction:start",(function(t){var e=t.event;return r.publish("dragstart",{items:r.getSelection(),event:e})})),this.subscribe("Interaction:end",(function(t){var e=t.event;return r.publish("callback",{items:r.getSelection(),event:e})})),this.start()}return n(e,[{key:"_callbacksTemp",value:function(t){var e=t.callback,n=t.onDragMove,i=t.onDragStart,r=t.onDragStartBegin,o=t.onElementSelect,s=t.onElementUnselect,l=function(t,e){return console.warn("[DragSelect] ".concat(t,' is deprecated. Use DragSelect.subscribe("').concat(e,'", (callbackObject) => {}) instead. Act Now! See docs for more info'))};e&&(l("callback","callback"),this.subscribe("callback",(function(t){var n=t.items,i=(t.item,t.event);return e(n,i)}))),n&&(l("onDragMove","dragmove"),this.subscribe("dragmove",(function(t){t.items,t.item;var e=t.event;return n(e)}))),i&&(l("onDragStart","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return i(e)}))),r&&(l("onDragStartBegin","dragstart"),this.subscribe("dragstart",(function(t){t.items,t.item;var e=t.event;return r(e)}))),o&&(l("onElementSelect","elementselect"),this.subscribe("elementselect",(function(t){t.items;var e=t.item,n=t.event;return o(e,n)}))),s&&(l("onElementUnselect","elementunselect"),this.subscribe("elementunselect",(function(t){t.items;var e=t.item,n=t.event;return s(e,n)})))}},{key:"stop",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0;n&&this.publish("callback",{items:this.getSelection()}),this.Interaction.stop(),this.Selector.stop(),this.Area.stop(),this.stores.KeyStore.stop(),this.stores.PointerStore.stop(),this.stores.ScrollStore.stop(),t&&this.SelectableSet.clear(),e&&this.SelectedSet.clear()}},{key:"addSelection",value:function(t,e,n){return this.SelectedSet.addAll(E(t)),n||this.addSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"removeSelection",value:function(t,e,n){return this.SelectedSet.deleteAll(E(t)),n&&this.removeSelectables(t),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"toggleSelection",value:function(t,e,n){var i=this;return E(t).forEach((function(r){return i.SelectedSet.has(r)?i.removeSelection(t,e,n):i.addSelection(t,e,n)})),e&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"setSelection",value:function(t,e,n){return this.clearSelection(),this.addSelection(t,e,n),this.getSelection()}},{key:"clearSelection",value:function(t){return this.SelectedSet.clear(),t&&this.PubSub.publish("callback",{items:this.getSelection()}),this.getSelection()}},{key:"addSelectables",value:function(t,e){var n=E(t);return this.SelectableSet.addAll(n),e&&this.SelectedSet.addAll(n),t}},{key:"setSelectables",value:function(t,e,n){return this.removeSelectables(t,e),this.addSelectables(t,n)}},{key:"removeSelectables",value:function(t,e){return this.SelectedSet.clear(),e&&this.SelectedSet.clear(),t}},{key:"getCursorPositionDifference",value:function(t){var e=this.getCurrentCursorPosition(),n=t?this.getPreviousCursorPosition():this.getInitialCursorPosition();return b(e,"-",n)}}]),e}();export default R;